"use strict";(()=>{var e={};e.id=5072,e.ids=[5072],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},70767:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>w,originalPathname:()=>x,patchFetch:()=>k,requestAsyncStorage:()=>h,routeModule:()=>v,serverHooks:()=>S,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>b});var i={};t.r(i),t.d(i,{GET:()=>y});var n=t(95419),a=t(69108),o=t(99678),s=t(78070),u=t(22345),l=t(11185),d=t.n(l);let p=new(d()).Schema({title:{type:String,required:[!0,"Başlık zorunludur"],trim:!0},description:{type:String,required:[!0,"A\xe7ıklama zorunludur"],trim:!0},price:{type:Number,required:[!0,"\xdccret zorunludur"]},method:{type:String,enum:["online","y\xfczy\xfcze","hibrit"],default:"online"},duration:{type:Number,required:[!0,"S\xfcre zorunludur"]},frequency:{type:String,enum:["daily","weekly","monthly","flexible"],default:"weekly"},status:{type:String,enum:["active","inactive"],default:"active"},userId:{type:String,required:!0}},{timestamps:!0}),c=d().models.Ilan||d().model("Ilan",p),m=new(d()).Schema({name:String,email:String,role:String,university:String,expertise:String}),g=d().models.User||d().model("User",m);async function y(e){try{await (0,u.Z)();let{searchParams:r}=new URL(e.url),t=r.get("university"),i=r.get("search")||"";if(!t)return s.Z.json({error:"\xdcniversite parametresi gereklidir"},{status:400});let n={userId:{$in:(await g.find({university:{$regex:RegExp("^"+t+"$","i")},role:"teacher"}).select("_id")).map(e=>e._id.toString())},status:"active"};i&&(n.$or=[{title:{$regex:i,$options:"i"}},{description:{$regex:i,$options:"i"}}]);let a=await c.find(n).sort({createdAt:-1}),o=await Promise.all(a.map(async e=>{let r=await g.findOne({_id:e.userId}).select("name email university expertise");return{...e.toObject(),teacher:r?r.toObject():null}}));return s.Z.json(o)}catch(e){return console.error("\xdcniversite ilanları getirme hatası:",e),s.Z.json({error:e.message||"İlanlar getirilirken bir hata oluştu"},{status:500})}}let v=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/ilanlar/university/route",pathname:"/api/ilanlar/university",filename:"route",bundlePath:"app/api/ilanlar/university/route"},resolvedPagePath:"C:\\Users\\eren\\Kavun, organization\\app\\api\\ilanlar\\university\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:h,staticGenerationAsyncStorage:f,serverHooks:S,headerHooks:w,staticGenerationBailout:b}=v,x="/api/ilanlar/university/route";function k(){return(0,o.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:f})}},22345:(e,r,t)=>{t.d(r,{Z:()=>s});var i=t(11185),n=t.n(i);let a=process.env.MONGODB_URI;if(!a)throw Error("MongoDB URI bulunamadı. L\xfctfen .env dosyasını kontrol edin.");let o=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=o);let s=async function(){if(o.conn)return o.conn;o.promise||(o.promise=n().connect(a,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[1638,6206],()=>t(70767));module.exports=i})();