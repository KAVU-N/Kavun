"use strict";(()=>{var e={};e.id=8923,e.ids=[8923],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},23302:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>v,originalPathname:()=>k,patchFetch:()=>S,requestAsyncStorage:()=>y,routeModule:()=>h,serverHooks:()=>b,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>w});var n={};t.r(n),t.d(n,{GET:()=>p,POST:()=>g});var a=t(95419),o=t(69108),i=t(99678),u=t(78070),l=t(22345),s=t(11185),d=t.n(s);let c=new(d()).Schema({title:{type:String,required:[!0,"Başlık zorunludur"],trim:!0},description:{type:String,required:[!0,"A\xe7ıklama zorunludur"],trim:!0},price:{type:Number,required:[!0,"\xdccret zorunludur"]},method:{type:String,enum:["online","y\xfczy\xfcze","hibrit"],default:"online"},duration:{type:Number,required:[!0,"S\xfcre zorunludur"]},frequency:{type:String,enum:["daily","weekly","monthly","flexible"],default:"weekly"},status:{type:String,enum:["active","inactive"],default:"active"},userId:{type:String,required:!0}},{timestamps:!0}),m=d().models.Ilan||d().model("Ilan",c);async function p(e){try{await (0,l.Z)();let{searchParams:r}=new URL(e.url),t=r.get("userId"),n={};t&&(n={userId:t});let a=await m.find(n).sort({createdAt:-1});return u.Z.json(a)}catch(e){return console.error("İlanları getirme hatası:",e),u.Z.json({error:e.message||"İlanlar getirilirken bir hata oluştu"},{status:500})}}async function g(e){try{await (0,l.Z)();let r=await e.json(),{title:t,description:n,price:a,method:o,duration:i,frequency:s}=r,d=e.headers.get("authorization");if(!d||!d.startsWith("Bearer "))return u.Z.json({error:"Yetkilendirme başarısız"},{status:401});d.split(" ")[1];let c=r.userId;if(!c)return u.Z.json({error:"Kullanıcı kimliği bulunamadı"},{status:400});let p=await m.create({title:t,description:n,price:Number(a),method:o,duration:Number(i),frequency:s,status:"active",userId:c.toString()});return u.Z.json(p,{status:201})}catch(e){return console.error("İlan oluşturma hatası:",e),u.Z.json({error:e.message||"İlan oluşturulurken bir hata oluştu"},{status:500})}}let h=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/ilanlar/route",pathname:"/api/ilanlar",filename:"route",bundlePath:"app/api/ilanlar/route"},resolvedPagePath:"C:\\Users\\eren\\Kavun, organization\\app\\api\\ilanlar\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:y,staticGenerationAsyncStorage:f,serverHooks:b,headerHooks:v,staticGenerationBailout:w}=h,k="/api/ilanlar/route";function S(){return(0,i.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:f})}},22345:(e,r,t)=>{t.d(r,{Z:()=>u});var n=t(11185),a=t.n(n);let o=process.env.MONGODB_URI;if(!o)throw Error("MongoDB URI bulunamadı. L\xfctfen .env dosyasını kontrol edin.");let i=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=i);let u=async function(){if(i.conn)return i.conn;i.promise||(i.promise=a().connect(o,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[1638,6206],()=>t(23302));module.exports=n})();