"use strict";(()=>{var e={};e.id=919,e.ids=[919],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32407:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>Z,originalPathname:()=>v,patchFetch:()=>I,requestAsyncStorage:()=>k,routeModule:()=>b,serverHooks:()=>j,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>S});var n={};t.r(n),t.d(n,{DELETE:()=>h,GET:()=>y,PUT:()=>f});var a=t(95419),i=t(69108),o=t(99678),s=t(78070),u=t(22345),l=t(11185),d=t.n(l);let m=new(d()).Schema({title:{type:String,required:[!0,"Başlık zorunludur"],trim:!0},description:{type:String,required:[!0,"A\xe7ıklama zorunludur"],trim:!0},price:{type:Number,required:[!0,"\xdccret zorunludur"]},method:{type:String,enum:["online","y\xfczy\xfcze","hibrit"],default:"online"},duration:{type:Number,required:[!0,"S\xfcre zorunludur"]},frequency:{type:String,enum:["daily","weekly","monthly","flexible"],default:"weekly"},status:{type:String,enum:["active","inactive"],default:"active"},userId:{type:String,required:!0}},{timestamps:!0}),c=d().models.Ilan||d().model("Ilan",m),p=new(d()).Schema({name:String,email:String,role:String,university:String,expertise:String}),g=d().models.User||d().model("User",p);async function y(e,{params:r}){try{if(await (0,u.Z)(),!r.id)return s.Z.json({error:"İlan ID parametresi gereklidir"},{status:400});let e=await c.findById(r.id);if(!e)return s.Z.json({error:"İlan bulunamadı"},{status:404});let t=await g.findOne({_id:e.userId}).select("name email university expertise"),n={...e.toObject(),teacher:t?t.toObject():null};return s.Z.json(n)}catch(e){return console.error("İlan detayları getirme hatası:",e),s.Z.json({error:e.message||"İlan detayları getirilirken bir hata oluştu"},{status:500})}}async function f(e,{params:r}){try{if(await (0,u.Z)(),!r.id)return s.Z.json({error:"İlan ID parametresi gereklidir"},{status:400});let t=await e.json(),{userId:n}=t,a=await c.findById(r.id);if(!a)return s.Z.json({error:"İlan bulunamadı"},{status:404});if(a.userId.toString()!==n)return s.Z.json({error:"Bu işlem i\xe7in yetkiniz bulunmamaktadır"},{status:403});let i=await c.findByIdAndUpdate(r.id,{$set:t},{new:!0,runValidators:!0});return s.Z.json(i)}catch(e){return console.error("İlan g\xfcncelleme hatası:",e),s.Z.json({error:e.message||"İlan g\xfcncellenirken bir hata oluştu"},{status:500})}}async function h(e,{params:r}){try{if(await (0,u.Z)(),!r.id)return s.Z.json({error:"İlan ID parametresi gereklidir"},{status:400});let{searchParams:t}=new URL(e.url),n=t.get("userId");if(!n)return s.Z.json({error:"Kullanıcı kimliği gereklidir"},{status:400});let a=await c.findById(r.id);if(!a)return s.Z.json({error:"İlan bulunamadı"},{status:404});if(a.userId.toString()!==n)return s.Z.json({error:"Bu işlem i\xe7in yetkiniz bulunmamaktadır"},{status:403});return await c.findByIdAndDelete(r.id),s.Z.json({message:"İlan başarıyla silindi"})}catch(e){return console.error("İlan silme hatası:",e),s.Z.json({error:e.message||"İlan silinirken bir hata oluştu"},{status:500})}}let b=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/ilanlar/[id]/route",pathname:"/api/ilanlar/[id]",filename:"route",bundlePath:"app/api/ilanlar/[id]/route"},resolvedPagePath:"C:\\Users\\eren\\Kavun, organization\\app\\api\\ilanlar\\[id]\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:k,staticGenerationAsyncStorage:w,serverHooks:j,headerHooks:Z,staticGenerationBailout:S}=b,v="/api/ilanlar/[id]/route";function I(){return(0,o.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:w})}},22345:(e,r,t)=>{t.d(r,{Z:()=>s});var n=t(11185),a=t.n(n);let i=process.env.MONGODB_URI;if(!i)throw Error("MongoDB URI bulunamadı. L\xfctfen .env dosyasını kontrol edin.");let o=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=o);let s=async function(){if(o.conn)return o.conn;o.promise||(o.promise=a().connect(i,{bufferCommands:!1}).then(e=>e));try{o.conn=await o.promise}catch(e){throw o.promise=null,e}return o.conn}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[1638,6206],()=>t(32407));module.exports=n})();