"use strict";(()=>{var e={};e.id=5321,e.ids=[5321],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},79330:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>w,staticGenerationAsyncStorage:()=>A,staticGenerationBailout:()=>C});var a={};t.r(a),t.d(a,{OPTIONS:()=>p,PUT:()=>m});var n=t(95419),o=t(69108),s=t(99678),i=t(78070),l=t(2544),u=t.n(l),d=t(52055),c=t(22345);async function p(){return i.Z.json({},{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization","Access-Control-Allow-Credentials":"true"}})}async function m(e){try{let{id:r,currentPassword:t,newPassword:a}=await e.json();await (0,c.Z)();let n=await d.Z.findById(r).select("+password");if(!n)return i.Z.json({error:"Kullanıcı bulunamadı"},{status:404,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"}});if(!await u().compare(t,n.password))return i.Z.json({error:"Mevcut şifre hatalı"},{status:401,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"}});let o=await u().hash(a,10);return n.password=o,await n.save(),i.Z.json({message:"Şifre başarıyla g\xfcncellendi"},{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"}})}catch(e){return console.error("Update error:",e),i.Z.json({error:"Şifre g\xfcncellenirken bir hata oluştu"},{status:500,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"}})}}let g=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/update/route",pathname:"/api/auth/update",filename:"route",bundlePath:"app/api/auth/update/route"},resolvedPagePath:"C:\\Users\\eren\\Kavun, organization\\app\\api\\auth\\update\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:A,serverHooks:w,headerHooks:f,staticGenerationBailout:C}=g,y="/api/auth/update/route";function v(){return(0,s.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:A})}},22345:(e,r,t)=>{t.d(r,{Z:()=>i});var a=t(11185),n=t.n(a);let o=process.env.MONGODB_URI;if(!o)throw Error("MongoDB URI bulunamadı. L\xfctfen .env dosyasını kontrol edin.");let s=global.mongoose||{conn:null,promise:null};global.mongoose||(global.mongoose=s);let i=async function(){if(s.conn)return s.conn;s.promise||(s.promise=n().connect(o,{bufferCommands:!1}).then(e=>e));try{s.conn=await s.promise}catch(e){throw s.promise=null,e}return s.conn}},52055:(e,r,t)=>{t.d(r,{Z:()=>s});var a=t(11185),n=t.n(a);let o=new a.Schema({name:{type:String,required:[!0,"Ad alanı zorunludur"],trim:!0,minlength:[2,"Ad en az 2 karakter olmalıdır"],maxlength:[50,"Ad en fazla 50 karakter olabilir"]},email:{type:String,required:[!0,"Email alanı zorunludur"],unique:!0,trim:!0,lowercase:!0,validate:{validator:function(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)},message:"Ge\xe7erli bir email adresi giriniz"}},password:{type:String,required:[!0,"Şifre alanı zorunludur"],minlength:[8,"Şifre en az 8 karakter olmalıdır"],select:!1},role:{type:String,required:[!0,"Rol alanı zorunludur"],enum:{values:["student","teacher"],message:"Ge\xe7erli bir rol se\xe7iniz"}},university:{type:String,required:[!0,"\xdcniversite alanı zorunludur"],trim:!0},isVerified:{type:Boolean,default:!1},verificationCode:String,verificationCodeExpires:Date,resetPasswordCode:String,resetPasswordExpires:Date,expertise:{type:String,default:"",trim:!0},createdAt:{type:Date,default:Date.now}},{timestamps:!0,strict:!0,strictQuery:!0,collection:"users"});o.index({email:1},{unique:!0});try{n().deleteModel("User")}catch(e){}let s=n().model("User",o)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1638,6206,6521],()=>t(79330));module.exports=a})();