"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[160],{2406:function(e,t,r){r.r(t),r.d(t,{AuthProvider:function(){return o},useAuth:function(){return i}});var s=r(3827),a=r(4090),n=r(7907);let l=(0,a.createContext)({user:null,loading:!1,error:null,login:async()=>{},register:async()=>{},logout:async()=>{},setUser:()=>{}});function o(e){let{children:t}=e,[r,o]=(0,a.useState)(null),[i,d]=(0,a.useState)(!0),[c,h]=(0,a.useState)(null),[u,x]=(0,a.useState)(!1),m=(0,n.useRouter)();(0,a.useEffect)(()=>{x(!0);try{let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);o(t)}}catch(e){console.error("Error loading user from localStorage:",e)}finally{d(!1)}},[]);let f=async e=>{d(!0),h(null);try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(403===t.status&&r.needsVerification){h("L\xfctfen \xf6nce email adresinizi doğrulayın"),m.push("/auth/verify?email=".concat(encodeURIComponent(r.email)));return}if(!t.ok)throw Error(r.error||"Giriş yapılırken bir hata oluştu");o(r.user),localStorage.setItem("user",JSON.stringify(r.user)),localStorage.setItem("token",r.token),"student"===r.user.role?m.push("/egitmenler"):m.push("/")}catch(e){throw h(e.message),e}finally{d(!1)}},p=async e=>{d(!0),h(null);try{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw Error(r.error||"Kayıt olurken bir hata oluştu");let s=null;r.user?(s=r.user,console.log("API yanıtı result.user i\xe7inde bulundu:",s)):r.id||r._id||r.name||r.email?(s=r,console.log("API yanıtı doğrudan result i\xe7inde bulundu:",s)):(console.log("API yanıtında kullanıcı verisi bulunamadı, ge\xe7ici kullanıcı oluşturuluyor"),s={id:Math.random().toString(36).substring(2,15),name:e.name,email:e.email,role:e.role,university:e.university,isVerified:!1}),console.log("Kullanıcının kayıt formunda se\xe7tiği rol:",e.role),console.log("API yanıtında gelen rol (varsa):",s.role);let a={id:s.id||s._id||"",name:s.name||e.name||"",email:s.email||e.email||"",role:e.role||s.role||"student",university:s.university||e.university||"",isVerified:s.isVerified||!1,expertise:s.expertise};console.log("Doğrulanmış kullanıcı verisi:",a),m.push("/auth/verify?email=".concat(encodeURIComponent(a.email)))}catch(e){throw console.error("Kayıt hatası:",e),h(e.message),e}finally{d(!1)}},v=async()=>{d(!0),h(null);try{let e=await fetch("/api/auth/logout",{method:"POST"});if(!e.ok){let t=await e.json();throw Error(t.error||"\xc7ıkış yapılırken bir hata oluştu")}o(null),localStorage.removeItem("user"),localStorage.removeItem("token"),m.push("/auth/login")}catch(e){throw h(e.message),e}finally{d(!1)}};return u?(0,s.jsx)(l.Provider,{value:{user:r,loading:i,error:c,login:f,register:p,logout:v,setUser:o},children:t}):(0,s.jsx)(l.Provider,{value:{user:null,loading:!0,error:null,login:async()=>{},register:async()=>{},logout:async()=>{},setUser:()=>{}},children:t})}function i(){return(0,a.useContext)(l)}},1160:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var s=r(3827),a=r(4090),n=r(8792),l=r(7907),o=r(2406),i=r(703);function d(){let[e,t]=(0,a.useState)(!1),[r,d]=(0,a.useState)(!1),[c,h]=(0,a.useState)(!1),[u,x]=(0,a.useState)(!1),[m,f]=(0,a.useState)(0),p=(0,a.useRef)(null),v=(0,l.usePathname)(),{user:j,logout:g}=(0,o.useAuth)();(0,a.useEffect)(()=>{x(!0);let e=()=>{t(window.scrollY>10)};return window.addEventListener("scroll",e),j&&F(),()=>window.removeEventListener("scroll",e)},[j]),(0,a.useEffect)(()=>{if(!u)return;j&&F();let e=setInterval(()=>{j&&F()},6e4);return()=>clearInterval(e)},[u,j]),(0,a.useEffect)(()=>{if(!u)return;let e=e=>{p.current&&!p.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[u]);let F=async()=>{try{let e=localStorage.getItem("token");if(!e)return;let t=await fetch("/api/messages/unread",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();f(e.count||0)}}catch(e){console.error("Okunmamış mesajlar kontrol edilirken hata oluştu:",e)}},k=[{href:"/ilanlar",label:"İlanlar",icon:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}];return(0,s.jsx)("div",{className:"fixed w-full z-50",children:u?(()=>{let t=j&&"string"==typeof j.role&&"teacher"===j.role;return(0,s.jsxs)("nav",{className:"w-full transition-all duration-500 ".concat(e?"bg-white/90 backdrop-blur-md shadow-lg py-2":"bg-transparent py-4"),children:[(0,s.jsx)("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsxs)(n.default,{href:"/",className:"flex items-center space-x-2 group",children:[(0,s.jsx)(i.default,{src:"/logo.png",alt:"Kavun Logo",width:40,height:40,className:"mr-2"}),(0,s.jsx)("span",{className:"text-2xl font-bold transition-all duration-300 ".concat(e?"text-[#6B3416]":"text-[#994D1C]"," group-hover:text-[#FF8B5E]"),children:"KAVUN"})]})}),(0,s.jsx)("div",{className:"hidden md:flex items-center justify-center flex-1",children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[k.map(e=>(0,s.jsxs)(n.default,{href:e.href,className:"flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-300 ".concat(v===e.href?"text-[#6B3416] font-medium bg-[#FFF5F0] shadow-sm":"text-[#994D1C] hover:text-[#6B3416] hover:bg-[#FFF5F0] hover:scale-105"),children:[e.icon,(0,s.jsx)("span",{children:e.label})]},e.href)),t&&(0,s.jsxs)(n.default,{href:"/ilan-ver",className:"flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-300 ".concat("/ilan-ver"===v?"text-[#6B3416] font-medium bg-[#FFF5F0] shadow-sm":"bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] text-white hover:shadow-lg hover:shadow-[#FFB996]/20 hover:scale-105"),children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,s.jsx)("span",{children:"İlan Ver"})]})]})}),(0,s.jsxs)("div",{className:"hidden md:flex items-center justify-end space-x-4",children:[!j&&(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(n.default,{href:"/auth/login",className:"px-6 py-2 rounded-xl text-[#994D1C] hover:text-[#6B3416] font-medium transition-all duration-300 hover:bg-[#FFF5F0] hover:scale-105",children:"Giriş Yap"}),(0,s.jsx)(n.default,{href:"/auth/register",className:"px-6 py-2 rounded-xl bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] text-white font-medium    transition-all duration-300 hover:shadow-lg hover:shadow-[#FFB996]/20 hover:scale-105 active:scale-[0.98]",children:"Kayıt Ol"})]}),j&&(0,s.jsxs)("div",{className:"relative",ref:p,children:[(0,s.jsxs)("button",{onClick:()=>h(!c),className:"flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-300 ".concat(c?"bg-[#FFF5F0] text-[#6B3416] shadow-sm":"text-[#994D1C] hover:text-[#6B3416] hover:bg-[#FFF5F0] hover:scale-105"),children:[(0,s.jsxs)("div",{className:"relative w-8 h-8 rounded-xl bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] flex items-center justify-center transform transition-all duration-300 hover:rotate-6",children:[(0,s.jsx)("span",{className:"text-white font-medium",children:j.name.charAt(0).toUpperCase()}),m>0&&(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center text-xs text-white font-bold",children:m>9?"9+":m})]}),(0,s.jsx)("span",{className:"font-medium",children:j.name}),(0,s.jsx)("svg",{className:"w-4 h-4 transition-transform duration-300 ".concat(c?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg py-2 z-50 border border-[#FFE5D9]",children:[(0,s.jsx)(n.default,{href:"/profil",className:"block px-4 py-2 text-[#994D1C] hover:bg-[#FFF5F0] hover:text-[#6B3416] transition-colors duration-300",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,s.jsx)("span",{children:"Profilim"})]})}),(0,s.jsx)(n.default,{href:"/mesajlarim",className:"block px-4 py-2 text-[#994D1C] hover:bg-[#FFF5F0] hover:text-[#6B3416] transition-colors duration-300",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),m>0&&(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]}),(0,s.jsx)("span",{children:"Mesajlarım"})]})}),"teacher"===j.role&&(0,s.jsx)(n.default,{href:"/ilanlarim",className:"block px-4 py-2 text-[#994D1C] hover:bg-[#FFF5F0] hover:text-[#6B3416] transition-colors duration-300",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),(0,s.jsx)("span",{children:"İlanlarım"})]})}),(0,s.jsx)("button",{onClick:g,className:"w-full text-left px-4 py-2 text-[#994D1C] hover:bg-[#FFF5F0] hover:text-[#6B3416] transition-colors duration-300",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,s.jsx)("span",{children:"\xc7ıkış Yap"})]})})]})]})]}),(0,s.jsx)("div",{className:"flex md:hidden",children:(0,s.jsx)("button",{onClick:()=>d(!r),className:"p-2 rounded-xl transition-all duration-300",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-[#994D1C]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r?(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]})}),r&&(0,s.jsx)("div",{className:"md:hidden bg-white shadow-lg rounded-b-xl overflow-hidden",children:(0,s.jsxs)("div",{className:"px-4 py-3 space-y-1",children:[k.map(e=>(0,s.jsxs)(n.default,{href:e.href,className:"flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-300 ".concat(v===e.href?"text-[#6B3416] font-medium bg-[#FFF5F0] shadow-sm":"text-[#994D1C] hover:text-[#6B3416] hover:bg-[#FFF5F0]"),onClick:()=>d(!1),children:[e.icon,(0,s.jsx)("span",{children:e.label})]},e.href)),j&&"teacher"===j.role&&(0,s.jsxs)(n.default,{href:"/ilan-ver",className:"flex items-center space-x-2 px-4 py-2 rounded-xl transition-all duration-300 ".concat("/ilan-ver"===v?"text-[#6B3416] font-medium bg-[#FFF5F0] shadow-sm":"bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] text-white"),onClick:()=>d(!1),children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,s.jsx)("span",{children:"İlan Ver"})]}),j?(0,s.jsxs)("div",{className:"space-y-2 mt-4 border-t border-[#FFE5D9] pt-4",children:[(0,s.jsxs)(n.default,{href:"/profil",className:"flex items-center space-x-2 px-4 py-2 rounded-xl text-[#994D1C] hover:text-[#6B3416] transition-all duration-300 hover:bg-[#FFF5F0]",onClick:()=>d(!1),children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,s.jsx)("span",{children:"Profilim"})]}),(0,s.jsxs)(n.default,{href:"/mesajlarim",className:"flex items-center space-x-2 px-4 py-2 rounded-xl text-[#994D1C] hover:text-[#6B3416] transition-all duration-300 hover:bg-[#FFF5F0]",onClick:()=>d(!1),children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),m>0&&(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]}),(0,s.jsx)("span",{children:"Mesajlarım"})]}),"teacher"===j.role&&(0,s.jsxs)(n.default,{href:"/ilanlarim",className:"flex items-center space-x-2 px-4 py-2 rounded-xl text-[#994D1C] hover:text-[#6B3416] transition-all duration-300 hover:bg-[#FFF5F0]",onClick:()=>d(!1),children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),(0,s.jsx)("span",{children:"İlanlarım"})]}),(0,s.jsxs)("button",{onClick:()=>{g(),d(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 rounded-xl text-[#994D1C] hover:text-[#6B3416] transition-all duration-300 hover:bg-[#FFF5F0] text-left",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,s.jsx)("span",{children:"\xc7ıkış Yap"})]})]}):(0,s.jsxs)("div",{className:"flex flex-col space-y-2 mt-4",children:[(0,s.jsx)(n.default,{href:"/auth/login",className:"px-6 py-2 rounded-xl text-[#994D1C] hover:text-[#6B3416] font-medium transition-all duration-300 hover:bg-[#FFF5F0] text-center",onClick:()=>d(!1),children:"Giriş Yap"}),(0,s.jsx)(n.default,{href:"/auth/register",className:"px-6 py-2 rounded-xl bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] text-white font-medium    transition-all duration-300 hover:shadow-lg hover:shadow-[#FFB996]/20 text-center",onClick:()=>d(!1),children:"Kayıt Ol"})]})]})})]})})():(0,s.jsx)("div",{className:"w-full py-4",children:(0,s.jsx)("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-10 h-10 mr-2"}),(0,s.jsx)("span",{className:"text-2xl font-bold text-[#994D1C]",children:"KAVUN"})]})}),(0,s.jsx)("div",{className:"hidden md:flex items-center justify-center flex-1",children:(0,s.jsx)("div",{className:"flex items-center space-x-1"})}),(0,s.jsx)("div",{className:"hidden md:flex items-center justify-end space-x-4",children:(0,s.jsx)("div",{className:"flex items-center space-x-4"})}),(0,s.jsx)("div",{className:"flex md:hidden",children:(0,s.jsx)("button",{className:"p-2 rounded-xl"})})]})})})})}}}]);