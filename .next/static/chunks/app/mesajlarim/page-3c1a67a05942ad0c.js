(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{1676:function(e,t,a){Promise.resolve().then(a.bind(a,8964))},8964:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var r=a(3827),l=a(4090),n=a(2406),s=a(8792),i=a(703),o=a(8049);function c(){let{user:e}=(0,n.useAuth)(),[t,a]=(0,l.useState)([]),[c,d]=(0,l.useState)(!0),[m,u]=(0,l.useState)(null),[h,x]=(0,l.useState)(null),[f,g]=(0,l.useState)(!1);(0,l.useEffect)(()=>{g(!0)},[]),(0,l.useEffect)(()=>{e&&f&&j()},[e,f]);let j=async()=>{try{d(!0);let e=localStorage.getItem("token");if(!e){console.error("Token bulunamadı"),u("Oturumunuz sonlanmış g\xf6r\xfcn\xfcyor. L\xfctfen tekrar giriş yapın."),d(!1);return}console.log("Konuşmalar getiriliyor, token mevcut:",!!e);let t=await fetch("/api/conversations",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(console.log("API yanıtı status:",t.status),!t.ok){let e;let a=await t.text();try{e=JSON.parse(a)}catch(t){e={error:a||"Bilinmeyen hata"}}throw console.error("API Hatası:",e),Error(e.error||"HTTP hata: ".concat(t.status))}let r=await t.json();console.log("Alınan konuşmalar:",r),Array.isArray(r)?a(r):(console.error("Beklenen dizi formatında veri alınamadı:",r),a([])),d(!1)}catch(e){console.error("Konuşmalar y\xfcklenirken hata oluştu:",e),u("Konuşmalar y\xfcklenirken bir hata oluştu: ".concat(e.message||"Bilinmeyen hata")),d(!1)}},y=async(e,t,a)=>{try{let r=localStorage.getItem("token");if(!r)return;let l=await fetch("/api/users/".concat(e),{headers:{Authorization:"Bearer ".concat(r)}});if(!l.ok){x({_id:e,name:t,email:"",profilePicture:a,university:"Bilinmiyor",role:"user"});return}let n=await l.json();x({_id:n._id,name:n.name,email:n.email||"",profilePicture:n.profilePicture,university:n.university||"Bilinmiyor",role:n.role||"user"})}catch(r){console.error("Kullanıcı detayları alınırken hata oluştu:",r),x({_id:e,name:t,email:"",profilePicture:a,university:"Bilinmiyor",role:"user"})}};return e?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 pt-24 flex-shrink-0",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:"Mesajlarım"}),c?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FF8B5E]"})}):m?(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,r.jsx)("p",{children:m})}):(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-[calc(100vh-200px)]",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden lg:col-span-1 h-full flex flex-col",children:[(0,r.jsx)("div",{className:"p-4 bg-[#FFE5D9] font-medium",children:"Konuşmalarım"}),0===t.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-[#FFE5D9] rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-[#FF8B5E]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Hen\xfcz mesajınız yok"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Eğitmenlerle mesajlaşmaya başlamak i\xe7in profillerini ziyaret edebilirsiniz."}),(0,r.jsx)(s.default,{href:"/egitmenler",className:"bg-[#FF8B5E] text-white px-4 py-2 rounded hover:bg-[#FF7F50] transition-colors",children:"Eğitmenleri Keşfet"})]}):(0,r.jsx)("div",{className:"overflow-y-auto flex-grow",children:t.map(e=>(0,r.jsxs)("div",{onClick:()=>y(e._id,e.name,e.avatar),className:"p-4 flex items-center space-x-3 cursor-pointer hover:bg-[#FFF5F0] transition-colors duration-300 ".concat((null==h?void 0:h._id)===e._id?"bg-[#FFF5F0]":""),children:[(0,r.jsxs)("div",{className:"relative",children:[e.avatar?(0,r.jsx)(i.default,{src:e.avatar,alt:e.name,width:48,height:48,className:"rounded-full"}):(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-medium",children:e.name.charAt(0).toUpperCase()})}),e.unread>0&&(0,r.jsx)("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-xs",children:e.unread>9?"9+":e.unread})})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:e.date})]}),(0,r.jsx)("p",{className:"text-xs truncate ".concat(e.unread>0?"font-medium text-gray-900":"text-gray-500"),children:e.lastMessage})]})]},e._id))})]}),(0,r.jsx)("div",{className:"lg:col-span-2 h-full flex flex-col overflow-hidden",children:h?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md h-full flex flex-col overflow-hidden",children:(0,r.jsx)(o.Z,{instructor:{_id:h._id,name:h.name,email:h.email,university:h.university,role:h.role},onClose:()=>{x(null),j()},embedded:!0})}):(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md h-full flex flex-col items-center justify-center p-6 text-center",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-[#FFE5D9] rounded-full flex items-center justify-center mb-4",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-[#FF8B5E]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,r.jsx)("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:"Mesajlaşmaya Başlayın"}),(0,r.jsx)("p",{className:"text-gray-600 max-w-md mb-6",children:"Sol taraftan bir konuşma se\xe7in veya eğitmen profillerini ziyaret ederek yeni bir mesajlaşma başlatın."}),(0,r.jsx)(s.default,{href:"/egitmenler",className:"bg-[#FF8B5E] text-white px-6 py-2 rounded-lg hover:bg-[#FF7F50] transition-colors",children:"Eğitmenleri Keşfet"})]})})]})]})}):(0,r.jsx)("div",{className:"min-h-screen pt-24 px-4 flex flex-col items-center justify-center bg-[#FFF9F5]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-[#994D1C] mb-4",children:"Mesajlarınızı g\xf6rmek i\xe7in giriş yapmalısınız"}),(0,r.jsx)(s.default,{href:"/auth/login",className:"inline-block px-6 py-2 rounded-xl bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] text-white font-medium transition-all duration-300 hover:shadow-lg hover:shadow-[#FFB996]/20 hover:scale-105",children:"Giriş Yap"})]})})}}},function(e){e.O(0,[792,703,323,49,971,69,744],function(){return e(e.s=1676)}),_N_E=e.O()}]);