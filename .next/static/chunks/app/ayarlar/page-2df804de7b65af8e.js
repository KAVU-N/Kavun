(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[507],{3456:function(e,t,r){Promise.resolve().then(r.bind(r,7204))},7204:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return o}});var s=r(3827),l=r(4090),n=r(2406);function o(){let{user:e}=(0,n.useAuth)(),[t,r]=(0,l.useState)("hesap"),[o,i]=(0,l.useState)(null),[a,d]=(0,l.useState)(""),[c,u]=(0,l.useState)(""),[m,h]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{if(null==e?void 0:e.id)try{let t=await fetch("/api/auth/user?id=".concat(e.id)),r=await t.json();t.ok?(console.log("User details:",r.user),i(r.user),d(r.user.expertise||"")):console.error("Error fetching user details:",r.error)}catch(e){console.error("Failed to fetch user details:",e)}})()},[null==e?void 0:e.id]);let x=async()=>{if(null==e?void 0:e.id)try{u(""),h("");let t=await fetch("/api/auth/update-expertise",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,expertise:a})}),r=await t.json();t.ok?(u("Uzmanlık alanı başarıyla g\xfcncellendi"),o&&i({...o,expertise:a})):h(r.error||"G\xfcncelleme sırasında bir hata oluştu")}catch(e){console.error("G\xfcncelleme hatası:",e),h("Beklenmeyen bir hata oluştu")}};return console.log("Context user:",e),console.log("User details:",o),(0,s.jsx)("div",{className:"min-h-screen bg-[#FFF5F0] pt-24 pb-12",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"border-b border-[#FFE5D9]",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("button",{onClick:()=>r("hesap"),className:"px-6 py-4 text-sm font-medium transition-colors duration-300 ".concat("hesap"===t?"text-[#6B3416] border-b-2 border-[#FF8B5E]":"text-[#994D1C] hover:text-[#6B3416]"),children:"Hesap Bilgileri"}),(0,s.jsx)("button",{onClick:()=>r("guvenlik"),className:"px-6 py-4 text-sm font-medium transition-colors duration-300 ".concat("guvenlik"===t?"text-[#6B3416] border-b-2 border-[#FF8B5E]":"text-[#994D1C] hover:text-[#6B3416]"),children:"G\xfcvenlik"})]})}),(0,s.jsxs)("div",{className:"p-6",children:["hesap"===t&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-[#6B3416]",children:"Hesap Bilgileri"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-[#994D1C]",children:"Hesap bilgileriniz."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-[#6B3416]",children:"Ad Soyad"}),(0,s.jsx)("div",{className:"mt-1 block w-full rounded-lg border border-[#FFE5D9] px-3 py-2 text-[#6B3416] bg-[#FFF5F0]",children:(null==o?void 0:o.name)||"Y\xfckleniyor..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-[#6B3416]",children:"E-posta"}),(0,s.jsx)("div",{className:"mt-1 block w-full rounded-lg border border-[#FFE5D9] px-3 py-2 text-[#6B3416] bg-[#FFF5F0]",children:(null==o?void 0:o.email)||"Y\xfckleniyor..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-[#6B3416]",children:"\xdcniversite"}),(0,s.jsx)("div",{className:"mt-1 block w-full rounded-lg border border-[#FFE5D9] px-3 py-2 text-[#6B3416] bg-[#FFF5F0]",children:(null==o?void 0:o.university)||"Belirtilmemiş"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-[#6B3416]",children:"Rol"}),(0,s.jsx)("div",{className:"mt-1 block w-full rounded-lg border border-[#FFE5D9] px-3 py-2 text-[#6B3416] bg-[#FFF5F0]",children:(null==o?void 0:o.role)==="student"?"\xd6ğrenci":"Eğitmen"})]}),(null==o?void 0:o.role)==="teacher"&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"expertise",className:"block text-sm font-medium text-[#6B3416]",children:"Verdiğiniz Ders / Uzmanlık Alanı"}),(0,s.jsxs)("div",{className:"mt-1 flex",children:[(0,s.jsx)("input",{id:"expertise",name:"expertise",type:"text",value:a,onChange:e=>d(e.target.value),placeholder:"\xd6rn: Veri Yapıları, Algoritmalar, Java Programlama...",className:"flex-grow block rounded-lg border border-[#FFE5D9] px-3 py-2 text-[#6B3416] shadow-sm focus:border-[#FF8B5E] focus:outline-none focus:ring-1 focus:ring-[#FF8B5E]"}),(0,s.jsx)("button",{type:"button",onClick:x,className:"ml-2 px-4 py-2 rounded-lg bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] text-white font-medium    transition-all duration-300 hover:shadow-lg hover:shadow-[#FFB996]/20 hover:scale-105 active:scale-[0.98]",children:"G\xfcncelle"})]}),c&&(0,s.jsx)("p",{className:"mt-2 text-sm text-green-600",children:c}),m&&(0,s.jsx)("p",{className:"mt-2 text-sm text-red-600",children:m})]})]})]}),"guvenlik"===t&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-[#6B3416]",children:"Şifre Değiştir"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-[#994D1C]",children:"Hesabınızın g\xfcvenliği i\xe7in şifrenizi değiştirebilirsiniz."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"current_password",className:"block text-sm font-medium text-[#6B3416]",children:"Mevcut Şifre"}),(0,s.jsx)("input",{type:"password",name:"current_password",id:"current_password",className:"mt-1 block w-full rounded-lg border border-[#FFE5D9] px-3 py-2 text-[#6B3416] shadow-sm focus:border-[#FF8B5E] focus:outline-none focus:ring-1 focus:ring-[#FF8B5E]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"new_password",className:"block text-sm font-medium text-[#6B3416]",children:"Yeni Şifre"}),(0,s.jsx)("input",{type:"password",name:"new_password",id:"new_password",className:"mt-1 block w-full rounded-lg border border-[#FFE5D9] px-3 py-2 text-[#6B3416] shadow-sm focus:border-[#FF8B5E] focus:outline-none focus:ring-1 focus:ring-[#FF8B5E]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirm_password",className:"block text-sm font-medium text-[#6B3416]",children:"Yeni Şifre (Tekrar)"}),(0,s.jsx)("input",{type:"password",name:"confirm_password",id:"confirm_password",className:"mt-1 block w-full rounded-lg border border-[#FFE5D9] px-3 py-2 text-[#6B3416] shadow-sm focus:border-[#FF8B5E] focus:outline-none focus:ring-1 focus:ring-[#FF8B5E]"})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"button",className:"px-6 py-2 rounded-xl bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] text-white font-medium    transition-all duration-300 hover:shadow-lg hover:shadow-[#FFB996]/20 hover:scale-105 active:scale-[0.98]",children:"Şifreyi Değiştir"})})]})]})]})})})}},2406:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return i},useAuth:function(){return a}});var s=r(3827),l=r(4090),n=r(7907);let o=(0,l.createContext)({user:null,loading:!1,error:null,login:async()=>{},register:async()=>{},logout:async()=>{},setUser:()=>{}});function i(e){let{children:t}=e,[r,i]=(0,l.useState)(null),[a,d]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null),[m,h]=(0,l.useState)(!1),x=(0,n.useRouter)();(0,l.useEffect)(()=>{h(!0);try{let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);i(t)}}catch(e){console.error("Error loading user from localStorage:",e)}finally{d(!1)}},[]);let f=async e=>{d(!0),u(null);try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(403===t.status&&r.needsVerification){u("L\xfctfen \xf6nce email adresinizi doğrulayın"),x.push("/auth/verify?email=".concat(encodeURIComponent(r.email)));return}if(!t.ok)throw Error(r.error||"Giriş yapılırken bir hata oluştu");i(r.user),localStorage.setItem("user",JSON.stringify(r.user)),localStorage.setItem("token",r.token),"student"===r.user.role?x.push("/egitmenler"):x.push("/")}catch(e){throw u(e.message),e}finally{d(!1)}},p=async e=>{d(!0),u(null);try{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(!t.ok)throw Error(r.error||"Kayıt olurken bir hata oluştu");let s=null;r.user?(s=r.user,console.log("API yanıtı result.user i\xe7inde bulundu:",s)):r.id||r._id||r.name||r.email?(s=r,console.log("API yanıtı doğrudan result i\xe7inde bulundu:",s)):(console.log("API yanıtında kullanıcı verisi bulunamadı, ge\xe7ici kullanıcı oluşturuluyor"),s={id:Math.random().toString(36).substring(2,15),name:e.name,email:e.email,role:e.role,university:e.university,isVerified:!1}),console.log("Kullanıcının kayıt formunda se\xe7tiği rol:",e.role),console.log("API yanıtında gelen rol (varsa):",s.role);let l={id:s.id||s._id||"",name:s.name||e.name||"",email:s.email||e.email||"",role:e.role||s.role||"student",university:s.university||e.university||"",isVerified:s.isVerified||!1,expertise:s.expertise};console.log("Doğrulanmış kullanıcı verisi:",l),x.push("/auth/verify?email=".concat(encodeURIComponent(l.email)))}catch(e){throw console.error("Kayıt hatası:",e),u(e.message),e}finally{d(!1)}},g=async()=>{d(!0),u(null);try{let e=await fetch("/api/auth/logout",{method:"POST"});if(!e.ok){let t=await e.json();throw Error(t.error||"\xc7ıkış yapılırken bir hata oluştu")}i(null),localStorage.removeItem("user"),localStorage.removeItem("token"),x.push("/auth/login")}catch(e){throw u(e.message),e}finally{d(!1)}};return m?(0,s.jsx)(o.Provider,{value:{user:r,loading:a,error:c,login:f,register:p,logout:g,setUser:i},children:t}):(0,s.jsx)(o.Provider,{value:{user:null,loading:!0,error:null,login:async()=>{},register:async()=>{},logout:async()=>{},setUser:()=>{}},children:t})}function a(){return(0,l.useContext)(o)}},7907:function(e,t,r){"use strict";var s=r(5313);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[971,69,744],function(){return e(e.s=3456)}),_N_E=e.O()}]);