(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[855],{5278:function(e,r,t){Promise.resolve().then(t.bind(t,492))},492:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return s}});var n=t(3827),i=t(4090),l=t(2406),o=t(7907),a=t(1399);function s(){let{user:e,loading:r}=(0,l.useAuth)(),t=(0,o.useRouter)(),[s,u]=(0,i.useState)({title:"",description:"",price:"",method:"online",duration:"",frequency:"weekly"}),[c,d]=(0,i.useState)(!1),[m,h]=(0,i.useState)(""),[f,p]=(0,i.useState)("");(0,i.useEffect)(()=>{r||e?!r&&e&&"teacher"!==e.role&&t.push("/"):t.push("/auth/login")},[e,r,t]);let y=e=>{let{name:r,value:t}=e.target;u(e=>({...e,[r]:t}))},g=async r=>{if(r.preventDefault(),!s.title.trim()){h("L\xfctfen bir başlık girin");return}if(!s.description.trim()){h("L\xfctfen bir a\xe7ıklama girin");return}if(!s.price.trim()){h("L\xfctfen \xfccret bilgisi girin");return}if(!s.duration.trim()){h("L\xfctfen s\xfcre bilgisi girin");return}try{if(d(!0),h(""),!e||!e.id){h("Kullanıcı kimliği bulunamadı. L\xfctfen tekrar giriş yapın."),d(!1);return}let r=localStorage.getItem("token");if(!r){h("Oturum bilgisi bulunamadı. L\xfctfen tekrar giriş yapın."),d(!1);return}console.log("Listing creation data:",{...s,userId:e.id});let n=await fetch("/api/ilanlar",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({...s,userId:e.id})});if(!n.ok){let e=await n.json();throw Error(e.error||"İlan oluşturulurken bir hata oluştu")}await n.json(),p("İlanınız başarıyla oluşturuldu!"),u({title:"",description:"",price:"",method:"online",duration:"",frequency:"weekly"}),setTimeout(()=>{t.push("/ilanlarim?refresh=true")},1500)}catch(e){if(console.error("İlan oluşturulurken hata:",e),h(e.message||"İlan oluşturulurken bir hata oluştu. L\xfctfen daha sonra tekrar deneyin."),e.response)try{let r=await e.response.json();console.error("API error details:",r)}catch(e){console.error("Error parsing API error:",e)}}finally{d(!1)}};return r||!e?(0,n.jsx)("div",{className:"min-h-screen bg-[#FFF5F0] pt-20",children:(0,n.jsx)("div",{className:"container mx-auto px-4",children:(0,n.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,n.jsx)("div",{className:"w-12 h-12 border-4 border-[#FFB996] border-t-[#FF8B5E] rounded-full animate-spin"})})})}):e&&"teacher"!==e.role?null:(0,n.jsx)("div",{className:"min-h-screen bg-[#FFF5F0] pt-24 pb-16",children:(0,n.jsx)("div",{className:"container mx-auto px-4",children:(0,n.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-[#6B3416] mb-8",children:"Yeni İlan Oluştur"}),f?(0,n.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-xl mb-6",children:f}):null,m?(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl mb-6",children:m}):null,(0,n.jsx)("form",{onSubmit:g,className:"bg-white p-6 rounded-xl shadow-md",children:(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"title",className:"block text-[#6B3416] font-medium mb-2",children:"İlan Başlığı"}),(0,n.jsx)("input",{type:"text",id:"title",name:"title",value:s.title,onChange:y,placeholder:"\xd6rn: Python Programlama Dersi",className:"w-full px-4 py-2 border border-[#FFE5D9] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FFB996]"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"description",className:"block text-[#6B3416] font-medium mb-2",children:"Detaylı A\xe7ıklama"}),(0,n.jsx)("textarea",{id:"description",name:"description",value:s.description,onChange:y,placeholder:"Ders i\xe7eriği ve kendiniz hakkında bilgi verin...",className:"w-full px-4 py-2 border border-[#FFE5D9] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FFB996] min-h-[150px]"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"price",className:"block text-[#6B3416] font-medium mb-2",children:"Ders \xdccreti (₺/Saat)"}),(0,n.jsx)("input",{type:"text",id:"price",name:"price",value:s.price,onChange:y,placeholder:"\xd6rn: 150",className:"w-full px-4 py-2 border border-[#FFE5D9] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FFB996]"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"method",className:"block text-[#6B3416] font-medium mb-2",children:"Ders Y\xf6ntemi"}),(0,n.jsxs)("select",{id:"method",name:"method",value:s.method,onChange:y,className:"w-full px-4 py-2 border border-[#FFE5D9] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FFB996]",children:[(0,n.jsx)("option",{value:"online",children:"Online"}),(0,n.jsx)("option",{value:"y\xfczy\xfcze",children:"Y\xfcz Y\xfcze"}),(0,n.jsx)("option",{value:"hibrit",children:"Hibrit (Online + Y\xfcz Y\xfcze)"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"duration",className:"block text-[#6B3416] font-medium mb-2",children:"Ders S\xfcresi (Saat)"}),(0,n.jsx)("input",{type:"text",id:"duration",name:"duration",value:s.duration,onChange:y,placeholder:"\xd6rn: 1.5",className:"w-full px-4 py-2 border border-[#FFE5D9] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FFB996]"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"frequency",className:"block text-[#6B3416] font-medium mb-2",children:"Ders Sıklığı"}),(0,n.jsxs)("select",{id:"frequency",name:"frequency",value:s.frequency,onChange:y,className:"w-full px-4 py-2 border border-[#FFE5D9] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#FFB996]",children:[(0,n.jsx)("option",{value:"daily",children:"G\xfcnl\xfck"}),(0,n.jsx)("option",{value:"weekly",children:"Haftalık"}),(0,n.jsx)("option",{value:"monthly",children:"Aylık"}),(0,n.jsx)("option",{value:"flexible",children:"Esnek"})]})]})]}),(0,n.jsx)("div",{className:"pt-4",children:(0,n.jsx)("button",{type:"submit",disabled:c,className:"w-full px-6 py-3 bg-gradient-to-r from-[#FFB996] to-[#FF8B5E] text-white font-medium rounded-lg flex items-center justify-center space-x-2 \n                    transition-all duration-300 hover:shadow-lg hover:shadow-[#FFB996]/20 ".concat(c?"opacity-70 cursor-not-allowed":""),children:c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-[#FF8B5E] rounded-full animate-spin"}),(0,n.jsx)("span",{children:"İşleniyor..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Y2X,{}),(0,n.jsx)("span",{children:"İlanı Yayınla"})]})})})]})})]})})})}},2406:function(e,r,t){"use strict";t.r(r),t.d(r,{AuthProvider:function(){return a},useAuth:function(){return s}});var n=t(3827),i=t(4090),l=t(7907);let o=(0,i.createContext)({user:null,loading:!1,error:null,login:async()=>{},register:async()=>{},logout:async()=>{},setUser:()=>{}});function a(e){let{children:r}=e,[t,a]=(0,i.useState)(null),[s,u]=(0,i.useState)(!0),[c,d]=(0,i.useState)(null),[m,h]=(0,i.useState)(!1),f=(0,l.useRouter)();(0,i.useEffect)(()=>{h(!0);try{let e=localStorage.getItem("user");if(e){let r=JSON.parse(e);a(r)}}catch(e){console.error("Error loading user from localStorage:",e)}finally{u(!1)}},[]);let p=async e=>{u(!0),d(null);try{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await r.json();if(403===r.status&&t.needsVerification){d("L\xfctfen \xf6nce email adresinizi doğrulayın"),f.push("/auth/verify?email=".concat(encodeURIComponent(t.email)));return}if(!r.ok)throw Error(t.error||"Giriş yapılırken bir hata oluştu");a(t.user),localStorage.setItem("user",JSON.stringify(t.user)),localStorage.setItem("token",t.token),"student"===t.user.role?f.push("/egitmenler"):f.push("/")}catch(e){throw d(e.message),e}finally{u(!1)}},y=async e=>{u(!0),d(null);try{let r=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await r.json();if(!r.ok)throw Error(t.error||"Kayıt olurken bir hata oluştu");let n=null;t.user?(n=t.user,console.log("API yanıtı result.user i\xe7inde bulundu:",n)):t.id||t._id||t.name||t.email?(n=t,console.log("API yanıtı doğrudan result i\xe7inde bulundu:",n)):(console.log("API yanıtında kullanıcı verisi bulunamadı, ge\xe7ici kullanıcı oluşturuluyor"),n={id:Math.random().toString(36).substring(2,15),name:e.name,email:e.email,role:e.role,university:e.university,isVerified:!1}),console.log("Kullanıcının kayıt formunda se\xe7tiği rol:",e.role),console.log("API yanıtında gelen rol (varsa):",n.role);let i={id:n.id||n._id||"",name:n.name||e.name||"",email:n.email||e.email||"",role:e.role||n.role||"student",university:n.university||e.university||"",isVerified:n.isVerified||!1,expertise:n.expertise};console.log("Doğrulanmış kullanıcı verisi:",i),f.push("/auth/verify?email=".concat(encodeURIComponent(i.email)))}catch(e){throw console.error("Kayıt hatası:",e),d(e.message),e}finally{u(!1)}},g=async()=>{u(!0),d(null);try{let e=await fetch("/api/auth/logout",{method:"POST"});if(!e.ok){let r=await e.json();throw Error(r.error||"\xc7ıkış yapılırken bir hata oluştu")}a(null),localStorage.removeItem("user"),localStorage.removeItem("token"),f.push("/auth/login")}catch(e){throw d(e.message),e}finally{u(!1)}};return m?(0,n.jsx)(o.Provider,{value:{user:t,loading:s,error:c,login:p,register:y,logout:g,setUser:a},children:r}):(0,n.jsx)(o.Provider,{value:{user:null,loading:!0,error:null,login:async()=>{},register:async()=>{},logout:async()=>{},setUser:()=>{}},children:r})}function s(){return(0,i.useContext)(o)}},7907:function(e,r,t){"use strict";var n=t(5313);t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(r,{useSearchParams:function(){return n.useSearchParams}})},158:function(e,r,t){"use strict";t.d(r,{w_:function(){return c}});var n=t(4090),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=n.createContext&&n.createContext(i),o=["attr","size","title"];function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function u(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach(function(r){var n,i;n=r,i=t[r],(n=function(e){var r=function(e,r){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,r||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:r+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function c(e){return r=>n.createElement(d,a({attr:u({},e.attr)},r),function e(r){return r&&r.map((r,t)=>n.createElement(r.tag,u({key:t},r.attr),e(r.child)))}(e.child))}function d(e){var r=r=>{var t,{attr:i,size:l,title:s}=e,c=function(e,r){if(null==e)return{};var t,n,i=function(e,r){if(null==e)return{};var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(r.indexOf(n)>=0)continue;t[n]=e[n]}return t}(e,r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}(e,o),d=l||r.size||"1em";return r.className&&(t=r.className),e.className&&(t=(t?t+" ":"")+e.className),n.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,c,{className:t,style:u(u({color:e.color||r.color},r.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),s&&n.createElement("title",null,s),e.children)};return void 0!==l?n.createElement(l.Consumer,null,e=>r(e)):r(i)}}},function(e){e.O(0,[699,971,69,744],function(){return e(e.s=5278)}),_N_E=e.O()}]);